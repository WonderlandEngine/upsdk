var f=class{providers=[];registerProvider(t){(t.available??!0)&&this.providers.push(t)}hasProviders(){return this.providers.length!==0}};var xe=(t=>(t.Unfilled="unfilled",t))(xe||{}),J=class extends f{name="uber-ad-provider";hasAd(){for(let t of this.providers)if(t.hasAd())return!0;return!1}showRewardedAd(t){for(let n of this.providers)if(n.hasAd())return n.showRewardedAd(t);return Promise.reject({status:"ads-unavailable",provider:this})}showMidgameAd(t){for(let n of this.providers)if(n.hasAd())return n.showMidgameAd(t);return Promise.reject({status:"ads-unavailable",provider:this})}},ht=new J;var ve=Object.defineProperty,Pe=Object.getOwnPropertyDescriptor,s=(e,t,n,r)=>{for(var i=r>1?void 0:r?Pe(t,n):t,o=e.length-1,m;o>=0;o--)(m=e[o])&&(i=(r?m(t,n,i):m(i))||i);return r&&i&&ve(t,n,i),i};var Ae=(e=>(e[e.Native=0]="Native",e[e.Bool=1]="Bool",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.String=4]="String",e[e.Enum=5]="Enum",e[e.Object=6]="Object",e[e.Mesh=7]="Mesh",e[e.Texture=8]="Texture",e[e.Material=9]="Material",e[e.Animation=10]="Animation",e[e.Skin=11]="Skin",e[e.Color=12]="Color",e[e.Vector2=13]="Vector2",e[e.Vector3=14]="Vector3",e[e.Vector4=15]="Vector4",e))(Ae||{}),Fe=class{clone(e,t){switch(e){case 12:case 13:case 14:case 15:return t.slice();default:return t}}},G=new Fe,ae={bool(e=!1){return{type:1,default:e}},int(e=0){return{type:2,default:e}},float(e=0){return{type:3,default:e}},string(e=""){return{type:4,default:e}},enum(e,t){return{type:5,values:e,default:t}},object(e){return{type:6,default:null,required:e?.required??!1}},mesh(e){return{type:7,default:null,required:e?.required??!1}},texture(e){return{type:8,default:null,required:e?.required??!1}},material(e){return{type:9,default:null,required:e?.required??!1}},animation(e){return{type:10,default:null,required:e?.required??!1}},skin(e){return{type:11,default:null,required:e?.required??!1}},color(e=0,t=0,n=0,r=1){return{type:12,default:[e,t,n,r]}},vector2(e=0,t=0){return{type:13,default:[e,t]}},vector3(e=0,t=0,n=0){return{type:14,default:[e,t,n]}},vector4(e=0,t=0,n=0,r=0){return{type:15,default:[e,t,n,r]}}};function he(e){return function(t,n){let r=t.constructor;r.Properties=r.hasOwnProperty("Properties")?r.Properties:{},r.Properties[n]=e}}function O(){return function(e,t,n){n.enumerable=!0}}function a(){return function(e,t,n){O()(e,t,n),he({type:0})(e,t)}}var Se={};for(let e in ae)Se[e]=(...t)=>{let n=ae[e];return he(n(...t))};var B=class{_listeners=[];_notifying=!1;_transactions=[];add(e,t={}){let{once:n=!1,id:r=void 0}=t,i={id:r,once:n,callback:e};return this._notifying?(this._transactions.push({type:1,data:i}),this):(this._listeners.push(i),this)}push(...e){for(let t of e)this.add(t);return this}once(e){return this.add(e,{once:!0})}remove(e){if(this._notifying)return this._transactions.push({type:2,data:e}),this;let t=this._listeners;for(let n=0;n<t.length;++n){let r=t[n];(r.callback===e||r.id===e)&&t.splice(n--,1)}return this}has(e){let t=this._listeners;for(let n=0;n<t.length;++n){let r=t[n];if(r.callback===e||r.id===e)return!0}return!1}notify(...e){let t=this._listeners;this._notifying=!0;for(let n=0;n<t.length;++n){let r=t[n];r.once&&t.splice(n--,1);try{r.callback(...e)}catch(i){console.error(i)}}this._notifying=!1,this._flushTransactions()}notifyUnsafe(...e){let t=this._listeners;for(let n=0;n<t.length;++n){let r=t[n];r.once&&t.splice(n--,1),r.callback(...e)}this._flushTransactions()}promise(){return new Promise((e,t)=>{this.once((...n)=>{n.length>1?e(n):e(n[0])})})}get listenerCount(){return this._listeners.length}get isEmpty(){return this.listenerCount===0}_flushTransactions(){let e=this._listeners;for(let t of this._transactions)t.type===1?e.push(t.data):this.remove(t.data);this._transactions.length=0}},q={},Me=class extends B{_event=q;_reset;add(e,t){let n=t?.immediate??!0;return this._event!==q&&n&&e(...this._event),super.add(e,t),this}once(e,t){return this.add(e,{once:!0,immediate:t})}notify(...e){this._event=e,super.notify(...e)}notifyUnsafe(...e){this._event=e,super.notifyUnsafe(...e)}reset(){return this._event=q,this}get data(){return this.isDataRetained?this._event:void 0}get isDataRetained(){return this._event!==q}};var Ee=class{_index=-1;_id=-1;_engine;constructor(e,t){this._engine=e,this._index=t,this._id=t}get engine(){return this._engine}get index(){return this._index}equals(e){return e?this._index===e._index:!1}get isDestroyed(){return this._index<=0}};function X(e){return new Proxy({},{get(t,n){if(n==="isDestroyed")return!0;throw new Error(`Cannot read '${n}' of destroyed ${e}`)},set(t,n){throw new Error(`Cannot write '${n}' of destroyed ${e}`)}})}var je=(e=>(e[e.Engine=0]="Engine",e[e.Scene=1]="Scene",e[e.Component=2]="Component",e))(je||{}),Ce=(e=>(e[e.Sphere=0]="Sphere",e[e.AxisAlignedBox=1]="AxisAlignedBox",e[e.Box=2]="Box",e))(Ce||{}),Te=(e=>(e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e))(Te||{}),Ue=(e=>(e[e.Line=0]="Line",e[e.Middle=1]="Middle",e[e.Top=2]="Top",e[e.Bottom=3]="Bottom",e))(Ue||{});var Ie=(e=>(e[e.None=0]="None",e[e.Outline=1]="Outline",e))(Ie||{}),ke=(e=>(e[e.None=0]="None",e[e.Soft=1]="Soft",e[e.Hard=2]="Hard",e[e.Clip=3]="Clip",e))(ke||{}),Re=(e=>(e[e.Head=0]="Head",e[e.EyeLeft=1]="EyeLeft",e[e.EyeRight=2]="EyeRight",e[e.ControllerLeft=3]="ControllerLeft",e[e.ControllerRight=4]="ControllerRight",e[e.RayLeft=5]="RayLeft",e[e.RayRight=6]="RayRight",e))(Re||{}),Le=(e=>(e[e.Perspective=0]="Perspective",e[e.Orthographic=1]="Orthographic",e))(Le||{}),De=(e=>(e[e.Point=0]="Point",e[e.Spot=1]="Spot",e[e.Sun=2]="Sun",e))(De||{}),He=(e=>(e[e.Playing=0]="Playing",e[e.Paused=1]="Paused",e[e.Stopped=2]="Stopped",e))(He||{}),Oe=(e=>(e[e.None=0]="None",e[e.ApplyToOwner=1]="ApplyToOwner",e[e.Script=2]="Script",e))(Oe||{}),Be=(e=>(e[e.Force=0]="Force",e[e.Impulse=1]="Impulse",e[e.VelocityChange=2]="VelocityChange",e[e.Acceleration=3]="Acceleration",e))(Be||{}),Ne=(e=>(e[e.Touch=0]="Touch",e[e.TouchLost=1]="TouchLost",e[e.TriggerTouch=2]="TriggerTouch",e[e.TriggerTouchLost=3]="TriggerTouchLost",e))(Ne||{}),ze=(e=>(e[e.None=0]="None",e[e.Sphere=1]="Sphere",e[e.Capsule=2]="Capsule",e[e.Box=3]="Box",e[e.Plane=4]="Plane",e[e.ConvexMesh=5]="ConvexMesh",e[e.TriangleMesh=6]="TriangleMesh",e))(ze||{}),$e=(e=>(e[e.Position=0]="Position",e[e.Tangent=1]="Tangent",e[e.Normal=2]="Normal",e[e.TextureCoordinate=3]="TextureCoordinate",e[e.Color=4]="Color",e[e.JointId=5]="JointId",e[e.JointWeight=6]="JointWeight",e))($e||{}),ct=X("object"),dt=X("component"),pt=X("prefab/scene");function oe(e){return e===5||e===6}function Ge(e){return!!e&&e.hasOwnProperty("_isBaseComponent")&&e._isBaseComponent}var We=Math.sqrt(3),M=class me{static _pack(t,n){return t<<22|n}static _isBaseComponent=!0;static _propertyOrder=[];static TypeName;static Properties;static InheritProperties;static onRegister;static _inheritProperties(){ce(this)}_manager;_id;_localId;_object;_scene;constructor(t,n=-1,r=-1){this._scene=t,this._manager=n,this._localId=r,this._id=me._pack(t._index,r),this._object=null}get scene(){return this._scene}get engine(){return this._scene.engine}get type(){return this.constructor.TypeName}get object(){if(!this._object){let t=this.engine.wasm._wl_component_get_object(this._manager,this._id);this._object=this._scene.wrap(t)}return this._object}set active(t){this.engine.wasm._wl_component_setActive(this._manager,this._id,t)}get active(){return this.markedActive&&this._scene.isActive}get markedActive(){return this.engine.wasm._wl_component_isActive(this._manager,this._id)!=0}copy(t){let n=this.constructor.Properties;if(!n)return this;for(let r in n){let i=n[r],o=t[r];if(o===void 0)continue;let m=i.cloner??G;this[r]=m.clone(i.type,o)}return this}destroy(){let t=this._manager;t<0||this._id<0||this.engine.wasm._wl_component_remove(t,this._id)}equals(t){return t?this._manager===t._manager&&this._id===t._id:!1}resetProperties(){let t=this.constructor.Properties;if(!t)return this;for(let n in t){let r=t[n],i=r.cloner??G;this[n]=i.clone(r.type,r.default)}return this}reset(){return this.resetProperties()}validateProperties(){let t=this.constructor;if(t.Properties){for(let n in t.Properties)if(t.Properties[n].required&&!this[n])throw new Error(`Property '${n}' is required but was not initialized`)}}toString(){return this.isDestroyed?"Component(destroyed)":`Component('${this.type}', ${this._localId})`}get isDestroyed(){return this._id<0}_copy(t,n){let r=this.engine.wasm,i=r.HEAPU32,o=n>>>2,m=this._scene,y=this.constructor;for(let E in y.Properties){let A=t[E];if(A===null){this[E]=null;continue}let F=y.Properties[E],w=i[o+F.type],j;switch(F.type){case 6:{let C=r._wl_object_index(A._id),T=r._wl_object_id(m._index,C+w);j=m.wrap(T);break}case 10:j=m.animations.wrap(w+A._index);break;case 11:j=m.skins.wrap(w+A._index);break;default:j=(F.cloner??G).clone(F.type,A);break}this[E]=j}return this}_triggerInit(){if(this.init)try{this.init()}catch(n){this.engine.log.error(2,`Exception during ${this.type} init() on object ${this.object.name}`),this.engine.log.error(2,n)}let t=this.onActivate;this.onActivate=function(){this.onActivate=t;let n=!1;try{this.validateProperties()}catch(r){this.engine.log.error(2,`Exception during ${this.type} validateProperties() on object ${this.object.name}`),this.engine.log.error(2,r),n=!0}try{this.start?.()}catch(r){this.engine.log.error(2,`Exception during ${this.type} start() on object ${this.object.name}`),this.engine.log.error(2,r),n=!0}if(n){this.active=!1;return}if(this.onActivate)try{this.onActivate()}catch(r){this.engine.log.error(2,`Exception during ${this.type} onActivate() on object ${this.object.name}`),this.engine.log.error(2,r)}}}_triggerUpdate(t){if(this.update)try{this.update(t)}catch(n){this.engine.log.error(2,`Exception during ${this.type} update() on object ${this.object.name}`),this.engine.log.error(2,n),this.engine.wasm._deactivate_component_on_error&&(this.active=!1)}}_triggerOnActivate(){if(this.onActivate)try{this.onActivate()}catch(t){this.engine.log.error(2,`Exception during ${this.type} onActivate() on object ${this.object.name}`),this.engine.log.error(2,t)}}_triggerOnDeactivate(){if(this.onDeactivate)try{this.onDeactivate()}catch(t){this.engine.log.error(2,`Exception during ${this.type} onDeactivate() on object ${this.object.name}`),this.engine.log.error(2,t)}}_triggerOnDestroy(){try{this.onDestroy&&this.onDestroy()}catch(t){this.engine.log.error(2,`Exception during ${this.type} onDestroy() on object ${this.object.name}`),this.engine.log.error(2,t)}this._scene._components.destroy(this)}},K=class extends M{static TypeName="__broken-component__"};function ce(e){if(!e.TypeName)return;let t=[],n=e;for(;n&&!Ge(n);){let i=n;if(!(!i.hasOwnProperty("InheritProperties")||i.InheritProperties))break;i.hasOwnProperty("Properties")&&t.push(i),n=Object.getPrototypeOf(n)}if(!t.length||t.length===1&&t[0]===e)return;let r={};for(let i=t.length-1;i>=0;--i)Object.assign(r,t[i].Properties);e.Properties=r}var Q=class extends M{static TypeName="collision";getExtents(e=new Float32Array(3)){let t=this.engine.wasm,n=t._wl_collision_component_get_extents(this._id)/4;return e[0]=t.HEAPF32[n],e[1]=t.HEAPF32[n+1],e[2]=t.HEAPF32[n+2],e}get collider(){return this.engine.wasm._wl_collision_component_get_collider(this._id)}set collider(e){this.engine.wasm._wl_collision_component_set_collider(this._id,e)}get extents(){let e=this.engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_collision_component_get_extents(this._id),3)}set extents(e){let t=this.engine.wasm,n=t._wl_collision_component_get_extents(this._id)/4;t.HEAPF32[n]=e[0],t.HEAPF32[n+1]=e[1],t.HEAPF32[n+2]=e[2]}get radius(){let e=this.engine.wasm;if(this.collider===0)return e.HEAPF32[e._wl_collision_component_get_extents(this._id)>>2];let t=new Float32Array(e.HEAPF32.buffer,e._wl_collision_component_get_extents(this._id),3),n=t[0]*t[0],r=t[1]*t[1],i=t[2]*t[2];return Math.sqrt(n+r+i)/2}set radius(e){let t=this.collider===0?e:2*e/We;this.extents.set([t,t,t])}get group(){return this.engine.wasm._wl_collision_component_get_group(this._id)}set group(e){this.engine.wasm._wl_collision_component_set_group(this._id,e)}queryOverlaps(){let e=this.engine.wasm._wl_collision_component_query_overlaps(this._id,this.engine.wasm._tempMem,this.engine.wasm._tempMemSize>>1),t=new Array(e);for(let n=0;n<e;++n){let r=this.engine.wasm._tempMemUint16[n];t[n]=this._scene._components.wrapCollision(r)}return t}};s([a()],Q.prototype,"collider",1),s([a()],Q.prototype,"extents",1),s([a()],Q.prototype,"group",1);var U=class extends M{static TypeName="text";get alignment(){return this.engine.wasm._wl_text_component_get_horizontal_alignment(this._id)}set alignment(e){this.engine.wasm._wl_text_component_set_horizontal_alignment(this._id,e)}get verticalAlignment(){return this.engine.wasm._wl_text_component_get_vertical_alignment(this._id)}set verticalAlignment(e){this.engine.wasm._wl_text_component_set_vertical_alignment(this._id,e)}get justification(){return this.verticalAlignment}set justification(e){this.verticalAlignment=e}get characterSpacing(){return this.engine.wasm._wl_text_component_get_character_spacing(this._id)}set characterSpacing(e){this.engine.wasm._wl_text_component_set_character_spacing(this._id,e)}get lineSpacing(){return this.engine.wasm._wl_text_component_get_line_spacing(this._id)}set lineSpacing(e){this.engine.wasm._wl_text_component_set_line_spacing(this._id,e)}get effect(){return this.engine.wasm._wl_text_component_get_effect(this._id)}set effect(e){this.engine.wasm._wl_text_component_set_effect(this._id,e)}get wrapMode(){return this.engine.wasm._wl_text_component_get_wrapMode(this._id)}set wrapMode(e){this.engine.wasm._wl_text_component_set_wrapMode(this._id,e)}get wrapWidth(){return this.engine.wasm._wl_text_component_get_wrapWidth(this._id)}set wrapWidth(e){this.engine.wasm._wl_text_component_set_wrapWidth(this._id,e)}get text(){let e=this.engine.wasm,t=e._wl_text_component_get_text(this._id);return e.UTF8ToString(t)}set text(e){let t=this.engine.wasm;t._wl_text_component_set_text(this._id,t.tempUTF8(e.toString()))}set material(e){let t=e?e._id:0;this.engine.wasm._wl_text_component_set_material(this._id,t)}get material(){let e=this.engine.wasm._wl_text_component_get_material(this._id);return this.engine.materials.wrap(e)}getBoundingBoxForText(e,t=new Float32Array(4)){let n=this.engine.wasm,r=n.tempUTF8(e,4*4);return this.engine.wasm._wl_text_component_get_boundingBox(this._id,r,n._tempMem),t[0]=n._tempMemFloat[0],t[1]=n._tempMemFloat[1],t[2]=n._tempMemFloat[2],t[3]=n._tempMemFloat[3],t}getBoundingBox(e=new Float32Array(4)){let t=this.engine.wasm;return this.engine.wasm._wl_text_component_get_boundingBox(this._id,0,t._tempMem),e[0]=t._tempMemFloat[0],e[1]=t._tempMemFloat[1],e[2]=t._tempMemFloat[2],e[3]=t._tempMemFloat[3],e}};s([a()],U.prototype,"alignment",1),s([a()],U.prototype,"verticalAlignment",1),s([a()],U.prototype,"justification",1),s([a()],U.prototype,"characterSpacing",1),s([a()],U.prototype,"lineSpacing",1),s([a()],U.prototype,"effect",1),s([a()],U.prototype,"wrapMode",1),s([a()],U.prototype,"wrapWidth",1),s([a()],U.prototype,"text",1),s([a()],U.prototype,"material",1);var H=class extends M{static TypeName="view";get projectionType(){return this.engine.wasm._wl_view_component_get_projectionType(this._id)}set projectionType(e){this.engine.wasm._wl_view_component_set_projectionType(this._id,e)}getProjectionMatrix(e=new Float32Array(16)){let t=this.engine.wasm,n=t._wl_view_component_get_projection_matrix(this._id)/4;for(let r=0;r<16;++r)e[r]=t.HEAPF32[n+r];return e}get projectionMatrix(){let e=this.engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_view_component_get_projection_matrix(this._id),16)}get near(){return this.engine.wasm._wl_view_component_get_near(this._id)}set near(e){this.engine.wasm._wl_view_component_set_near(this._id,e)}get far(){return this.engine.wasm._wl_view_component_get_far(this._id)}set far(e){this.engine.wasm._wl_view_component_set_far(this._id,e)}get fov(){return this.engine.wasm._wl_view_component_get_fov(this._id)}set fov(e){this.engine.wasm._wl_view_component_set_fov(this._id,e)}get extent(){return this.engine.wasm._wl_view_component_get_extent(this._id)}set extent(e){this.engine.wasm._wl_view_component_set_extent(this._id,e)}};s([a()],H.prototype,"projectionType",1),s([O()],H.prototype,"projectionMatrix",1),s([a()],H.prototype,"near",1),s([a()],H.prototype,"far",1),s([a()],H.prototype,"fov",1),s([a()],H.prototype,"extent",1);var Y=class extends M{static TypeName="input";get inputType(){return this.engine.wasm._wl_input_component_get_type(this._id)}set inputType(e){this.engine.wasm._wl_input_component_set_type(this._id,e)}get xrInputSource(){let e=this.engine.xr;if(!e)return null;for(let t of e.session.inputSources)if(t.handedness==this.handedness)return t;return null}get handedness(){let e=this.inputType;return e==4||e==6||e==2?"right":e==3||e==5||e==1?"left":null}};s([a()],Y.prototype,"inputType",1),s([O()],Y.prototype,"xrInputSource",1),s([O()],Y.prototype,"handedness",1);var S=class extends M{static TypeName="light";getColor(e=new Float32Array(3)){let t=this.engine.wasm,n=t._wl_light_component_get_color(this._id)/4;return e[0]=t.HEAPF32[n],e[1]=t.HEAPF32[n+1],e[2]=t.HEAPF32[n+2],e}setColor(e){let t=this.engine.wasm,n=t._wl_light_component_get_color(this._id)/4;t.HEAPF32[n]=e[0],t.HEAPF32[n+1]=e[1],t.HEAPF32[n+2]=e[2]}get color(){let e=this.engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_light_component_get_color(this._id),3)}set color(e){this.color.set(e)}get lightType(){return this.engine.wasm._wl_light_component_get_type(this._id)}set lightType(e){this.engine.wasm._wl_light_component_set_type(this._id,e)}get intensity(){return this.engine.wasm._wl_light_component_get_intensity(this._id)}set intensity(e){this.engine.wasm._wl_light_component_set_intensity(this._id,e)}get outerAngle(){return this.engine.wasm._wl_light_component_get_outerAngle(this._id)}set outerAngle(e){this.engine.wasm._wl_light_component_set_outerAngle(this._id,e)}get innerAngle(){return this.engine.wasm._wl_light_component_get_innerAngle(this._id)}set innerAngle(e){this.engine.wasm._wl_light_component_set_innerAngle(this._id,e)}get shadows(){return!!this.engine.wasm._wl_light_component_get_shadows(this._id)}set shadows(e){this.engine.wasm._wl_light_component_set_shadows(this._id,e)}get shadowRange(){return this.engine.wasm._wl_light_component_get_shadowRange(this._id)}set shadowRange(e){this.engine.wasm._wl_light_component_set_shadowRange(this._id,e)}get shadowBias(){return this.engine.wasm._wl_light_component_get_shadowBias(this._id)}set shadowBias(e){this.engine.wasm._wl_light_component_set_shadowBias(this._id,e)}get shadowNormalBias(){return this.engine.wasm._wl_light_component_get_shadowNormalBias(this._id)}set shadowNormalBias(e){this.engine.wasm._wl_light_component_set_shadowNormalBias(this._id,e)}get shadowTexelSize(){return this.engine.wasm._wl_light_component_get_shadowTexelSize(this._id)}set shadowTexelSize(e){this.engine.wasm._wl_light_component_set_shadowTexelSize(this._id,e)}get cascadeCount(){return this.engine.wasm._wl_light_component_get_cascadeCount(this._id)}set cascadeCount(e){this.engine.wasm._wl_light_component_set_cascadeCount(this._id,e)}};s([a()],S.prototype,"color",1),s([a()],S.prototype,"lightType",1),s([a()],S.prototype,"intensity",1),s([a()],S.prototype,"outerAngle",1),s([a()],S.prototype,"innerAngle",1),s([a()],S.prototype,"shadows",1),s([a()],S.prototype,"shadowRange",1),s([a()],S.prototype,"shadowBias",1),s([a()],S.prototype,"shadowNormalBias",1),s([a()],S.prototype,"shadowTexelSize",1),s([a()],S.prototype,"cascadeCount",1);var z=class extends M{static TypeName="animation";onEvent=new B;set animation(e){this.scene.assertOrigin(e),this.engine.wasm._wl_animation_component_set_animation(this._id,e?e._id:0)}get animation(){let e=this.engine.wasm._wl_animation_component_get_animation(this._id);return this._scene.animations.wrap(e)}set playCount(e){this.engine.wasm._wl_animation_component_set_playCount(this._id,e)}get playCount(){return this.engine.wasm._wl_animation_component_get_playCount(this._id)}set speed(e){this.engine.wasm._wl_animation_component_set_speed(this._id,e)}get speed(){return this.engine.wasm._wl_animation_component_get_speed(this._id)}get state(){return this.engine.wasm._wl_animation_component_state(this._id)}get rootMotionMode(){return this.engine.wasm._wl_animation_component_get_rootMotionMode(this._id)}set rootMotionMode(e){this.engine.wasm._wl_animation_component_set_rootMotionMode(this._id,e)}get iteration(){return this.engine.wasm._wl_animation_component_get_iteration(this._id)}get position(){return this.engine.wasm._wl_animation_component_get_position(this._id)}get duration(){return this.engine.wasm._wl_animation_component_get_duration(this._id)}play(){this.engine.wasm._wl_animation_component_play(this._id)}stop(){this.engine.wasm._wl_animation_component_stop(this._id)}pause(){this.engine.wasm._wl_animation_component_pause(this._id)}getFloatParameter(e){let t=this.engine.wasm,n=t._wl_animation_component_getGraphParamIndex(this._id,t.tempUTF8(e));if(n===-1)throw Error(`Missing parameter '${e}'`);return t._wl_animation_component_getGraphParamValue(this._id,n,t._tempMem),t._tempMemFloat[0]}setFloatParameter(e,t){let n=this.engine.wasm,r=n._wl_animation_component_getGraphParamIndex(this._id,n.tempUTF8(e));if(r===-1)throw Error(`Missing parameter '${e}'`);n._tempMemFloat[0]=t,n._wl_animation_component_setGraphParamValue(this._id,r,n._tempMem)}getRootMotionTranslation(e=new Float32Array(3)){let t=this.engine.wasm;return t._wl_animation_component_get_rootMotion_translation(this._id,t._tempMem),e[0]=t._tempMemFloat[0],e[1]=t._tempMemFloat[1],e[2]=t._tempMemFloat[2],e}getRootMotionRotation(e=new Float32Array(3)){let t=this.engine.wasm;return t._wl_animation_component_get_rootMotion_rotation(this._id,t._tempMem),e[0]=t._tempMemFloat[0],e[1]=t._tempMemFloat[1],e[2]=t._tempMemFloat[2],e}};s([a()],z.prototype,"animation",1),s([a()],z.prototype,"playCount",1),s([a()],z.prototype,"speed",1),s([O()],z.prototype,"state",1),s([a(),O()],z.prototype,"rootMotionMode",1);var $=class extends M{static TypeName="mesh";set material(e){this.engine.wasm._wl_mesh_component_set_material(this._id,e?e._id:0)}get material(){let e=this.engine.wasm._wl_mesh_component_get_material(this._id);return this.engine.materials.wrap(e)}get mesh(){let e=this.engine.wasm._wl_mesh_component_get_mesh(this._id);return this.engine.meshes.wrap(e)}set mesh(e){this.engine.wasm._wl_mesh_component_set_mesh(this._id,e?._id??0)}get skin(){let e=this.engine.wasm._wl_mesh_component_get_skin(this._id);return this._scene.skins.wrap(e)}set skin(e){this.scene.assertOrigin(e),this.engine.wasm._wl_mesh_component_set_skin(this._id,e?e._id:0)}get morphTargets(){let e=this.engine.wasm._wl_mesh_component_get_morph_targets(this._id);return this.engine.morphTargets.wrap(e)}set morphTargets(e){this.engine.wasm._wl_mesh_component_set_morph_targets(this._id,e?._id??0)}get morphTargetWeights(){return this.getMorphTargetWeights()}set morphTargetWeights(e){this.setMorphTargetWeights(e)}getMorphTargetWeights(e){let t=this.engine.wasm,n=t._wl_mesh_component_get_morph_target_weights(this._id,t._tempMem);e||(e=new Float32Array(n));for(let r=0;r<n;++r)e[r]=t._tempMemFloat[r];return e}getMorphTargetWeight(e){let t=this.morphTargets?.count??0;if(e>=t)throw new Error(`Index ${e} is out of bounds for ${t} targets`);return this.engine.wasm._wl_mesh_component_get_morph_target_weight(this._id,e)}setMorphTargetWeights(e){let t=this.morphTargets?.count??0;if(e.length!==t)throw new Error(`Expected ${t} weights but got ${e.length}`);let n=this.engine.wasm;n._tempMemFloat.set(e),n._wl_mesh_component_set_morph_target_weights(this._id,n._tempMem,e.length)}setMorphTargetWeight(e,t){let n=this.morphTargets?.count??0;if(e>=n)throw new Error(`Index ${e} is out of bounds for ${n} targets`);this.engine.wasm._wl_mesh_component_set_morph_target_weight(this._id,e,t)}};s([a()],$.prototype,"material",1),s([a()],$.prototype,"mesh",1),s([a()],$.prototype,"skin",1),s([a()],$.prototype,"morphTargets",1),s([a()],$.prototype,"morphTargetWeights",1);var Ve=(e=>(e[e.None=0]="None",e[e.X=1]="X",e[e.Y=2]="Y",e[e.Z=4]="Z",e))(Ve||{}),g=class extends M{static TypeName="physx";getTranslationOffset(e=new Float32Array(3)){let t=this.engine.wasm;return t._wl_physx_component_get_offsetTranslation(this._id,t._tempMem),e[0]=t._tempMemFloat[0],e[1]=t._tempMemFloat[1],e[2]=t._tempMemFloat[2],e}getRotationOffset(e=new Float32Array(4)){let t=this.engine.wasm,n=t._wl_physx_component_get_offsetTransform(this._id)>>2;return e[0]=t.HEAPF32[n],e[1]=t.HEAPF32[n+1],e[2]=t.HEAPF32[n+2],e[3]=t.HEAPF32[n+3],e}getExtents(e=new Float32Array(3)){let t=this.engine.wasm,n=t._wl_physx_component_get_extents(this._id)/4;return e[0]=t.HEAPF32[n],e[1]=t.HEAPF32[n+1],e[2]=t.HEAPF32[n+2],e}getLinearVelocity(e=new Float32Array(3)){let t=this.engine.wasm,n=t._tempMemFloat;return t._wl_physx_component_get_linearVelocity(this._id,t._tempMem),e[0]=n[0],e[1]=n[1],e[2]=n[2],e}getAngularVelocity(e=new Float32Array(3)){let t=this.engine.wasm,n=t._tempMemFloat;return t._wl_physx_component_get_angularVelocity(this._id,t._tempMem),e[0]=n[0],e[1]=n[1],e[2]=n[2],e}set static(e){this.engine.wasm._wl_physx_component_set_static(this._id,e)}get static(){return!!this.engine.wasm._wl_physx_component_get_static(this._id)}get translationOffset(){return this.getTranslationOffset()}set translationOffset(e){this.engine.wasm._wl_physx_component_set_offsetTranslation(this._id,e[0],e[1],e[2])}get rotationOffset(){return this.getRotationOffset()}set rotationOffset(e){this.engine.wasm._wl_physx_component_set_offsetRotation(this._id,e[0],e[1],e[2],e[3])}set kinematic(e){this.engine.wasm._wl_physx_component_set_kinematic(this._id,e)}get kinematic(){return!!this.engine.wasm._wl_physx_component_get_kinematic(this._id)}set gravity(e){this.engine.wasm._wl_physx_component_set_gravity(this._id,e)}get gravity(){return!!this.engine.wasm._wl_physx_component_get_gravity(this._id)}set simulate(e){this.engine.wasm._wl_physx_component_set_simulate(this._id,e)}get simulate(){return!!this.engine.wasm._wl_physx_component_get_simulate(this._id)}set allowSimulation(e){this.engine.wasm._wl_physx_component_set_allowSimulation(this._id,e)}get allowSimulation(){return!!this.engine.wasm._wl_physx_component_get_allowSimulation(this._id)}set allowQuery(e){this.engine.wasm._wl_physx_component_set_allowQuery(this._id,e)}get allowQuery(){return!!this.engine.wasm._wl_physx_component_get_allowQuery(this._id)}set trigger(e){this.engine.wasm._wl_physx_component_set_trigger(this._id,e)}get trigger(){return!!this.engine.wasm._wl_physx_component_get_trigger(this._id)}set shape(e){this.engine.wasm._wl_physx_component_set_shape(this._id,e)}get shape(){return this.engine.wasm._wl_physx_component_get_shape(this._id)}set shapeData(e){e==null||!oe(this.shape)||this.engine.wasm._wl_physx_component_set_shape_data(this._id,e.index)}get shapeData(){return oe(this.shape)?{index:this.engine.wasm._wl_physx_component_get_shape_data(this._id)}:null}set extents(e){this.extents.set(e)}get extents(){let e=this.engine.wasm,t=e._wl_physx_component_get_extents(this._id);return new Float32Array(e.HEAPF32.buffer,t,3)}get staticFriction(){return this.engine.wasm._wl_physx_component_get_staticFriction(this._id)}set staticFriction(e){this.engine.wasm._wl_physx_component_set_staticFriction(this._id,e)}get dynamicFriction(){return this.engine.wasm._wl_physx_component_get_dynamicFriction(this._id)}set dynamicFriction(e){this.engine.wasm._wl_physx_component_set_dynamicFriction(this._id,e)}get bounciness(){return this.engine.wasm._wl_physx_component_get_bounciness(this._id)}set bounciness(e){this.engine.wasm._wl_physx_component_set_bounciness(this._id,e)}get linearDamping(){return this.engine.wasm._wl_physx_component_get_linearDamping(this._id)}set linearDamping(e){this.engine.wasm._wl_physx_component_set_linearDamping(this._id,e)}get angularDamping(){return this.engine.wasm._wl_physx_component_get_angularDamping(this._id)}set angularDamping(e){this.engine.wasm._wl_physx_component_set_angularDamping(this._id,e)}set linearVelocity(e){this.engine.wasm._wl_physx_component_set_linearVelocity(this._id,e[0],e[1],e[2])}get linearVelocity(){let e=this.engine.wasm;return e._wl_physx_component_get_linearVelocity(this._id,e._tempMem),new Float32Array(e.HEAPF32.buffer,e._tempMem,3)}set angularVelocity(e){this.engine.wasm._wl_physx_component_set_angularVelocity(this._id,e[0],e[1],e[2])}get angularVelocity(){let e=this.engine.wasm;return e._wl_physx_component_get_angularVelocity(this._id,e._tempMem),new Float32Array(e.HEAPF32.buffer,e._tempMem,3)}set groupsMask(e){this.engine.wasm._wl_physx_component_set_groupsMask(this._id,e)}get groupsMask(){return this.engine.wasm._wl_physx_component_get_groupsMask(this._id)}set blocksMask(e){this.engine.wasm._wl_physx_component_set_blocksMask(this._id,e)}get blocksMask(){return this.engine.wasm._wl_physx_component_get_blocksMask(this._id)}set linearLockAxis(e){this.engine.wasm._wl_physx_component_set_linearLockAxis(this._id,e)}get linearLockAxis(){return this.engine.wasm._wl_physx_component_get_linearLockAxis(this._id)}set angularLockAxis(e){this.engine.wasm._wl_physx_component_set_angularLockAxis(this._id,e)}get angularLockAxis(){return this.engine.wasm._wl_physx_component_get_angularLockAxis(this._id)}set mass(e){this.engine.wasm._wl_physx_component_set_mass(this._id,e)}get mass(){return this.engine.wasm._wl_physx_component_get_mass(this._id)}set massSpaceInteriaTensor(e){this.engine.wasm._wl_physx_component_set_massSpaceInertiaTensor(this._id,e[0],e[1],e[2])}set sleepOnActivate(e){this.engine.wasm._wl_physx_component_set_sleepOnActivate(this._id,e)}get sleepOnActivate(){return!!this.engine.wasm._wl_physx_component_get_sleepOnActivate(this._id)}addForce(e,t=0,n=!1,r,i=!1){let o=this.engine.wasm;if(!r){o._wl_physx_component_addForce(this._id,e[0],e[1],e[2],t,n);return}o._wl_physx_component_addForceAt(this._id,e[0],e[1],e[2],t,n,r[0],r[1],r[2],i)}addTorque(e,t=0){this.engine.wasm._wl_physx_component_addTorque(this._id,e[0],e[1],e[2],t)}onCollision(e){return this.onCollisionWith(this,e)}onCollisionWith(e,t){let n=this.scene._pxCallbacks;return n.has(this._id)||n.set(this._id,[]),n.get(this._id).push(t),this.engine.wasm._wl_physx_component_addCallback(this._id,e._id)}removeCollisionCallback(e){let t=this.engine.wasm._wl_physx_component_removeCallback(this._id,e),n=this.scene._pxCallbacks;t&&n.get(this._id).splice(-t)}};s([a()],g.prototype,"static",1),s([a()],g.prototype,"translationOffset",1),s([a()],g.prototype,"rotationOffset",1),s([a()],g.prototype,"kinematic",1),s([a()],g.prototype,"gravity",1),s([a()],g.prototype,"simulate",1),s([a()],g.prototype,"allowSimulation",1),s([a()],g.prototype,"allowQuery",1),s([a()],g.prototype,"trigger",1),s([a()],g.prototype,"shape",1),s([a()],g.prototype,"shapeData",1),s([a()],g.prototype,"extents",1),s([a()],g.prototype,"staticFriction",1),s([a()],g.prototype,"dynamicFriction",1),s([a()],g.prototype,"bounciness",1),s([a()],g.prototype,"linearDamping",1),s([a()],g.prototype,"angularDamping",1),s([a()],g.prototype,"linearVelocity",1),s([a()],g.prototype,"angularVelocity",1),s([a()],g.prototype,"groupsMask",1),s([a()],g.prototype,"blocksMask",1),s([a()],g.prototype,"linearLockAxis",1),s([a()],g.prototype,"angularLockAxis",1),s([a()],g.prototype,"mass",1),s([a()],g.prototype,"sleepOnActivate",1);var qe=(e=>(e[e.UnsignedByte=1]="UnsignedByte",e[e.UnsignedShort=2]="UnsignedShort",e[e.UnsignedInt=4]="UnsignedInt",e))(qe||{}),Ke=(e=>(e[e.None=0]="None",e[e.FourJoints=1]="FourJoints",e[e.EightJoints=2]="EightJoints",e))(Ke||{});var Xe=class{#e;#t;constructor(e,t){this.#e=e,this.#t=t}get sessionMode(){return this.#t}get session(){return this.#e.webxr_session}get frame(){return this.#e.webxr_frame}referenceSpaceForType(e){return this.#e.webxr_refSpaces[e]??null}set currentReferenceSpace(e){this.#e.webxr_refSpace=e,this.#e.webxr_refSpaceType=null;for(let t of Object.keys(this.#e.webxr_refSpaces))this.#e.webxr_refSpaces[t]===e&&(this.#e.webxr_refSpaceType=t)}get currentReferenceSpace(){return this.#e.webxr_refSpace}get currentReferenceSpaceType(){return this.#e.webxr_refSpaceType}get baseLayer(){return this.#e.webxr_baseLayer}get framebuffers(){return Array.isArray(this.#e.webxr_fbo)?this.#e.webxr_fbo.map(e=>this.#e.GL.framebuffers[e]):[this.#e.GL.framebuffers[this.#e.webxr_fbo]]}};var Je=(e=>(e[e.UnsignedInt=0]="UnsignedInt",e[e.Int=1]="Int",e[e.HalfFloat=2]="HalfFloat",e[e.Float=3]="Float",e[e.Sampler=4]="Sampler",e[e.Font=5]="Font",e))(Je||{}),gt=class extends Ee{static _destroyedPrototype=X("material");constructor(e,t){if(typeof t!="number"){if(!t?.pipeline)throw new Error("Missing parameter 'pipeline'");let n=e.materials.getTemplate(t.pipeline),r=new n;return super(e,r._index),r}super(e,t)}hasParameter(e){let t=this.constructor.Parameters;return t&&t.has(e)}get shader(){return this.pipeline}get pipeline(){let e=this.engine.wasm;return e.UTF8ToString(e._wl_material_get_pipeline(this._id))}clone(){let e=this.engine.wasm._wl_material_clone(this._id);return this.engine.materials.wrap(e)}toString(){return this.isDestroyed?"Material(destroyed)":`Material('${this.pipeline}', ${this._index})`}static wrap(e,t){return e.materials.wrap(t)}};var Qe=(e=>(e[e.Prefab=0]="Prefab",e[e.Main=1]="Main",e[e.Dependency=2]="Dependency",e))(Qe||{});function _e(e){if(e>=32)throw new Error(`BitSet.enable(): Value ${e} is over 31`)}var le=class{_bits=0;enable(...e){for(let t of e)_e(t),this._bits|=1<<t>>>0;return this}enableAll(){return this._bits=-1,this}disable(...e){for(let t of e)_e(t),this._bits&=~(1<<t>>>0);return this}disableAll(){return this._bits=0,this}enabled(e){return!!(this._bits&1<<e>>>0)}},Ye=(e=>(e[e.Info=0]="Info",e[e.Warn=1]="Warn",e[e.Error=2]="Error",e))(Ye||{}),Ze=class{levels=new le;tags=new le().enableAll();constructor(...e){this.levels.enable(...e)}info(e,...t){return this.levels.enabled(0)&&this.tags.enabled(e)&&console.log(...t),this}warn(e,...t){return this.levels.enabled(1)&&this.tags.enabled(e)&&console.warn(...t),this}error(e,...t){return this.levels.enabled(2)&&this.tags.enabled(e)&&console.error(...t),this}};function et(e,t=(r,i)=>i,n={}){let{dictionary:r="object"}=n,i=new DataView(e.buffer,e.byteOffset,e.byteLength),o=0;function m(d,p){return o+=d,p}function y(d){return m(d,e.subarray(o,o+d))}function E(){let d=5960464477539063e-23,p=new ArrayBuffer(4),b=new DataView(p),l=j(),_=l&32768,h=l&31744,u=l&1023;if(h===31744)h=261120;else if(h!==0)h+=114688;else if(u!==0)return(_?-1:1)*u*d;return b.setUint32(0,_<<16|h<<13|u<<13),b.getFloat32(0)}function A(){return m(4,i.getFloat32(o))}function F(){return m(8,i.getFloat64(o))}function w(){return m(1,e[o])}function j(){return m(2,i.getUint16(o))}function C(){return m(4,i.getUint32(o))}function T(){return m(8,i.getBigUint64(o))}function N(){return e[o]!==255?!1:(o+=1,!0)}function W(d){if(d<24)return d;if(d===24)return w();if(d===25)return j();if(d===26)return C();if(d===27){let p=T();return p<=Number.MAX_SAFE_INTEGER?Number(p):p}if(d===31)return-1;throw new Error("CBORError: Invalid length encoding")}function L(d){let p=w();if(p===255)return-1;let b=W(p&31);if(b<0||p>>5!==d)throw new Error("CBORError: Invalid indefinite length element");return Number(b)}function D(d,p){for(let b=0;b<p;++b){let l=w();l&128&&(l<224?(l=(l&31)<<6|w()&63,p-=1):l<240?(l=(l&15)<<12|(w()&63)<<6|w()&63,p-=2):(l=(l&7)<<18|(w()&63)<<12|(w()&63)<<6|w()&63,p-=3)),l<65536?d.push(l):(l-=65536,d.push(55296|l>>10),d.push(56320|l&1023))}}function v(){let d=w(),p=d>>5,b=d&31,l,_;if(p===7)switch(b){case 25:return E();case 26:return A();case 27:return F()}if(_=W(b),_<0&&(p<2||6<p))throw new Error("CBORError: Invalid length");switch(p){case 0:return _;case 1:return typeof _=="number"?-1-_:-1n-_;case 2:{if(_<0){let h=[],u=0;for(;(_=L(p))>=0;)u+=_,h.push(y(_));let x=new Uint8Array(u),V=0;for(l=0;l<h.length;++l)x.set(h[l],V),V+=h[l].length;return x}return y(_).slice()}case 3:{let h=[];if(_<0)for(;(_=L(p))>=0;)D(h,_);else D(h,_);let u="",x=8192;for(l=0;l<h.length;l+=x)u+=String.fromCharCode.apply(null,h.slice(l,l+x));return u}case 4:{let h;if(_<0){h=[];let u=0;for(;!N();)h.push(v())}else for(h=new Array(_),l=0;l<_;++l)h[l]=v();return h}case 5:{if(r==="map"){let u=new Map;for(l=0;l<_||_<0&&!N();++l){let x=v();if(u.has(x))throw new Error("CBORError: Duplicate key encountered");u.set(x,v())}return u}let h={};for(l=0;l<_||_<0&&!N();++l){let u=v();if(Object.prototype.hasOwnProperty.call(h,u))throw new Error("CBORError: Duplicate key encountered");h[u]=v()}return h}case 6:{let h=v(),u=_;if(h instanceof Uint8Array)switch(u){case 2:case 3:let x=h.reduce((V,be)=>(V<<8n)+BigInt(be),0n);return u==3&&(x=-1n-x),x;case 64:return h;case 72:return new Int8Array(h.buffer);case 69:return new Uint16Array(h.buffer);case 77:return new Int16Array(h.buffer);case 70:return new Uint32Array(h.buffer);case 78:return new Int32Array(h.buffer);case 71:return new BigUint64Array(h.buffer);case 79:return new BigInt64Array(h.buffer);case 85:return new Float32Array(h.buffer);case 86:return new Float64Array(h.buffer)}return t(u,h)}case 7:switch(_){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;default:return _}}}let R=v();if(o!==e.byteLength)throw new Error("CBORError: Remaining bytes");return R}var tt={decode:et},nt=new Map([[1,!1],[2,0],[3,0],[4,""],[5,void 0],[6,null],[7,null],[8,null],[9,null],[10,null],[11,null],[12,Float32Array.from([0,0,0,1])],[13,Float32Array.from([0,0])],[14,Float32Array.from([0,0,0])],[15,Float32Array.from([0,0,0,0])]]);function rt(e){for(let t in e.Properties){let n=e.Properties[t];if(n.type===5)n.values?.length?(typeof n.default!="number"&&(n.default=n.values.indexOf(n.default)),(n.default<0||n.default>=n.values.length)&&(n.default=0)):n.default=void 0;else if((n.type===12||n.type===13||n.type===14||n.type===15)&&Array.isArray(n.default))n.default=Float32Array.from(n.default);else if(n.default===void 0){let r=n.cloner??G;n.default=r.clone(n.type,nt.get(n.type))}e.prototype[t]=n.default}}function it(e){e._propertyOrder=e.hasOwnProperty("Properties")?Object.keys(e.Properties).sort():[]}var c=class{worker="";wasm=null;canvas=null;preinitializedWebGPUDevice=null;webxr_session=null;webxr_requestSession=null;webxr_offerSession=null;webxr_frame=null;webxr_refSpace=null;webxr_refSpaces=null;webxr_refSpaceType=null;webxr_baseLayer=null;webxr_framebufferScaleFactor=1;webxr_fbo=0;UTF8ViewToString;_log=new Ze;_deactivate_component_on_error=!1;_tempMem=null;_tempMemSize=0;_tempMemFloat=null;_tempMemInt=null;_tempMemUint8=null;_tempMemUint32=null;_tempMemUint16=null;_loadingScreen=null;_sceneLoadedCallback=[];_images=[null];_components=null;_componentTypes=[];_componentTypeIndices={};_engine=null;_withPhysX=!1;_utf8Decoder=new TextDecoder("utf8");_brokenComponentIndex=0;constructor(e){e?this.UTF8ViewToString=(t,n)=>t?this._utf8Decoder.decode(this.HEAPU8.slice(t,n)):"":this.UTF8ViewToString=(t,n)=>t?this._utf8Decoder.decode(this.HEAPU8.subarray(t,n)):"",this._brokenComponentIndex=this._registerComponent(K)}reset(){this._wl_reset(),this._components=null,this._images.length=1,this.allocateTempMemory(1024),this._componentTypes=[],this._componentTypeIndices={},this._brokenComponentIndex=this._registerComponent(K)}isRegistered(e){return e in this._componentTypeIndices}_registerComponentLegacy(e,t,n){let r=class extends M{};return r.TypeName=e,r.Properties=t,Object.assign(r.prototype,n),this._registerComponent(r)}_registerComponent(e){if(!e.TypeName)throw new Error("no name provided for component.");if(!e.prototype._triggerInit)throw new Error(`registerComponent(): Component ${e.TypeName} must extend Component`);ce(e),rt(e),it(e);let t=e.TypeName in this._componentTypeIndices?this._componentTypeIndices[e.TypeName]:this._componentTypes.length;return this._componentTypes[t]=e,this._componentTypeIndices[e.TypeName]=t,e===K||(this._log.info(0,"Registered component",e.TypeName,`(class ${e.name})`,"with index",t),e.onRegister&&e.onRegister(this._engine)),t}allocateTempMemory(e){this._log.info(0,"Allocating temp mem:",e),this._tempMemSize=e,this._tempMem&&this._free(this._tempMem),this._tempMem=this._malloc(this._tempMemSize),this.updateTempMemory()}requireTempMem(e){this._tempMemSize>=e||this.allocateTempMemory(Math.ceil(e/1024)*1024)}updateTempMemory(){this._tempMemFloat=new Float32Array(this.HEAP8.buffer,this._tempMem,this._tempMemSize>>2),this._tempMemInt=new Int32Array(this.HEAP8.buffer,this._tempMem,this._tempMemSize>>2),this._tempMemUint32=new Uint32Array(this.HEAP8.buffer,this._tempMem,this._tempMemSize>>2),this._tempMemUint16=new Uint16Array(this.HEAP8.buffer,this._tempMem,this._tempMemSize>>1),this._tempMemUint8=new Uint8Array(this.HEAP8.buffer,this._tempMem,this._tempMemSize)}getTempBufferU8(e){return this.requireTempMem(e),this._tempMemUint8}getTempBufferU16(e){return this.requireTempMem(e*2),this._tempMemUint16}getTempBufferU32(e){return this.requireTempMem(e*4),this._tempMemUint32}getTempBufferI32(e){return this.requireTempMem(e*4),this._tempMemInt}getTempBufferF32(e){return this.requireTempMem(e*4),this._tempMemFloat}tempUTF8(e,t=0){let n=this.lengthBytesUTF8(e)+1;this.requireTempMem(n+t);let r=this._tempMem+t;return this.stringToUTF8(e,r,n),r}copyBufferToHeap(e){let t=e.byteLength,n=this._malloc(t);return this.HEAPU8.set(new Uint8Array(e),n),n}get withPhysX(){return this._withPhysX}_setEngine(e){this._engine=e}_wljs_xr_session_start(e){this._engine.xr===null&&(this._engine.xr=new Xe(this,e),this._engine.onXRSessionStart.notify(this.webxr_session,e))}_wljs_xr_session_end(){let e=this._engine.onXRSessionStart;e instanceof Me&&e.reset(),this._engine.onXRSessionEnd.notify(),this._engine.xr=null}_wljs_xr_disable(){this._engine.arSupported=!1,this._engine.vrSupported=!1}_wljs_init(e){this._withPhysX=e,this.allocateTempMemory(1024)}_wljs_scene_switch(e){let t=this._engine._scenes[e];this._components=t?._jsComponents??null}_wljs_destroy_image(e){let t=this._images[e];t&&(this._images[e]=null,t.src!==void 0&&(t.src=""),t.onload!==void 0&&(t.onload=null),t.onerror!==void 0&&(t.onerror=null))}_wljs_objects_markDestroyed(e,t,n){let r=this._engine._scenes[e],i=t>>>1;for(let o=0;o<n;++o){let m=this.HEAPU16[i+o];r._destroyObject(m)}}_wljs_scene_initialize(e,t,n,r,i,o,m){let y=this.HEAPU8.subarray(r,i),E=this.HEAPU32.subarray(o>>>2,m>>>2),A=this.HEAPU16.subarray(t>>>1,n>>>1),F=this._engine,w=F._scenes[e],j=w._jsComponents,C;try{C=tt.decode(y)}catch(T){this._log.error(0,"Exception during component parameter decoding"),this._log.error(2,T);return}if(!Array.isArray(C)){this._log.error(0,"Parameter data must be an array");return}if(C.length!==A.length){this._log.error(0,`Parameter data has size ${C.length} but expected ${A.length}`);return}for(let T=0;T<C.length;++T){let N=M._pack(e,A[T]),W=this._wl_get_js_component_index_for_id(N),L=j[W],D=L.constructor;if(D==K)continue;let v=D._propertyOrder,R=C[T];if(!Array.isArray(R)){this._log.error(0,"Component parameter data must be an array");continue}if(R.length!==v.length){this._log.error(0,`Component parameter data has size ${R.length} but expected ${v.length}`);continue}for(let d=0;d<R.length;++d){let p=v[d],b=D.Properties[p],l=b.type,_=R[d];if(_===void 0){_=(b.cloner??G).clone(l,b.default),L[p]=_;continue}switch(typeof _=="number"&&(_+=E[l]),l){case 1:case 2:case 3:case 4:case 5:case 13:case 14:case 15:break;case 6:_=_?w.wrap(this._wl_object_id(w._index,_)):null;break;case 7:_=F.meshes.wrap(_);break;case 8:_=F.textures.wrap(_);break;case 9:_=F.materials.wrap(_);break;case 10:_=w.animations.wrap(_);break;case 11:_=w.skins.wrap(_);break;case 12:let h=(1<<_.BYTES_PER_ELEMENT*8)-1;_=Float32Array.from(_,(u,x)=>u/h);break}L[p]=_}}}_wljs_set_component_param_translation(e,t,n,r,i){let o=this._engine._scenes[e]._jsComponents[t],m=this.UTF8ViewToString(r,i),y=o.constructor._propertyOrder[n];o[y]=m}_wljs_get_component_type_index(e,t){let n=this.UTF8ViewToString(e,t),r=this._componentTypeIndices[n];return r===void 0?this._brokenComponentIndex:r}_wljs_component_create(e,t,n,r,i){this._engine._scenes[e]._components.createJs(t,n,r,i)}_wljs_component_init(e,t){this._engine._scenes[e]._jsComponents[t]._triggerInit()}_wljs_component_update(e,t){this._components[e]._triggerUpdate(t)}_wljs_component_onActivate(e){this._components[e]._triggerOnActivate()}_wljs_component_onDeactivate(e){this._components[e]._triggerOnDeactivate()}_wljs_component_markDestroyed(e,t,n){this._engine._scenes[e]._destroyComponent(t,n)}_wljs_swap(e,t,n){let r=this._engine._scenes[e]._jsComponents,i=r[t];r[t]=r[n],r[n]=i}_wljs_copy(e,t,n,r,i){let o=this._engine._scenes[e],m=this._engine._scenes[n]._jsComponents[r],y=o._jsComponents[t];try{m._copy(y,i)}catch(E){this._log.error(2,`Exception during ${m.type} copy() on object ${m.object.name}`),this._log.error(2,E)}}_wljs_trigger_animationEvent(e,t,n){let r=this._engine.scene._components.wrapAnimation(e),i=this.UTF8ViewToString(t,n);r.onEvent.notify(i)}};function Z(e){return function(){throw new Error(`Feature added in version ${e}.
	\u2192 Please use a Wonderland Engine editor version >= ${e}`)}}var P=Z("1.2.1");c.prototype._wl_text_component_get_wrapMode=P;c.prototype._wl_text_component_set_wrapMode=P;c.prototype._wl_text_component_get_wrapWidth=P;c.prototype._wl_text_component_set_wrapWidth=P;c.prototype._wl_font_get_outlineSize=P;c.prototype._wl_scene_create_chunked_start=P;c.prototype._wl_scene_create_chunked_buffer_size=P;c.prototype._wl_scene_create_chunked_next=P;c.prototype._wl_scene_create_chunked_abort=P;c.prototype._wl_scene_create_chunked_end_prefab=P;c.prototype._wl_scene_create_chunked_end_main=P;c.prototype._wl_scene_create_chunked_end_queued=P;var k=Z("1.2.2");c.prototype._wl_view_component_get_projectionType=k;c.prototype._wl_view_component_set_projectionType=k;c.prototype._wl_view_component_get_extent=k;c.prototype._wl_view_component_set_extent=k;c.prototype._wl_animation_component_get_rootMotionMode=k;c.prototype._wl_animation_component_set_rootMotionMode=k;c.prototype._wl_animation_component_get_rootMotion_translation=k;c.prototype._wl_animation_component_get_rootMotion_rotation=k;var I=Z("1.2.3");c.prototype._wl_scene_environment_set_intensity=I;c.prototype._wl_scene_environment_get_intensity=I;c.prototype._wl_scene_environment_set_tint=I;c.prototype._wl_scene_environment_get_tint=I;c.prototype._wl_scene_environment_set_coefficients=I;c.prototype._wl_scene_environment_get_coefficients=I;c.prototype._wl_animation_component_get_iteration=I;c.prototype._wl_animation_component_get_position=I;c.prototype._wl_animation_component_get_duration=I;c.prototype._wl_renderer_streaming_idle=I;var ee=class extends f{name="uber-user-provider";onAuthChange=new B;providers=[];registerProvider(t){this.providers.push(t),t.onAuthChange&&t.onAuthChange.add(this.onAuthChange.notify.bind(this.onAuthChange))}get isLoggedIn(){for(let t of this.providers)if(t.isLoggedIn)return!0;return!1}get user(){for(let t of this.providers)if(t.isLoggedIn)return t.user;return null}requestLogin(){for(let t of this.providers)if(!t.isLoggedIn)return t.requestLogin();return Promise.reject()}},Ot=new ee;var te=class extends f{name="uber-savegame-provider";load(t){for(let n of this.providers){let r=n.load(t);if(r!=null)return r}return null}save(t){for(let n of this.providers)n.save(t)}},$t=new te;var ne=class extends f{name="uber-extra-provider";celebrate(){for(let t of this.providers)t.celebrate()}},qt=new ne;var re=class extends f{name="uber-analytics-provider";trackGameplayStart(){for(let t of this.providers)t.trackGameplayStart()}trackGameplayStop(){for(let t of this.providers)t.trackGameplayStop()}trackLoadingStart(){for(let t of this.providers)t.trackLoadingStart()}trackLoadingStop(){for(let t of this.providers)t.trackLoadingStop()}},Qt=new re;var ie=class extends f{name="uber-purchases-provider";purchaseItem(t,n){return this.hasProviders()?this.providers[this.providers.length-1].purchaseItem(t,n??1):Promise.reject(new Error("No providers available."))}getItemURL(t){return this.hasProviders()?this.providers[this.providers.length-1].getItemURL(t):Promise.reject(new Error("No providers available."))}isItemPurchased(t){if(!this.hasProviders())return!1;for(let n of this.providers)if(n.isItemPurchased(t))return!0;return!1}},tn=new ie;var se=class extends f{name="uber-leaderboards-provider";postScore(t,n){return Promise.all(this.providers.map(r=>r.postScore(t,n))).then(r=>r.reduce((i,o)=>i&&o,!0))}getScores(t,n){return this.hasProviders()?this.providers[this.providers.length-1].getScores(t,n):Promise.reject(new Error("No providers available."))}},an=new se;var de=class{name="adinplay";options;reachedAdMax=!1;rej;res;constructor(t){this.options=t;let n=document.createElement("div");n.id="videoad",document.body.prepend(n);let r=window.aiptag=window.aiptag||{};r.cmd=r.cmd||[],r.cmd.display=r.cmd.display||[],r.cmd.player=r.cmd.player||[],r.cmp={show:!0,position:"centered",button:!0,buttonText:"Privacy settings",buttonPosition:"bottom-left"};let i=this,o=document.createElement("script");o.onload=()=>{r.cmd.player.push(()=>{r.adplayer=new aipPlayer({AIP_REWARDEDNOTGRANTED:m=>{m=="unsupported"&&(this.reachedAdMax=!0),this.rej&&this.rej(m)},AIP_REWARDEDGRANTED:()=>{this.res&&this.res(i)},AD_WIDTH:960,AD_HEIGHT:540,AD_DISPLAY:"default",LOADING_TEXT:"loading ad...",PREROLL_ELEM:function(){return document.getElementById("videoad")},AIP_COMPLETE:function(){}})})},o.async=!0,o.src="//api.adinplay.com/libs/aiptag/pub/XXXXX/tag.min.js",document.body.appendChild(o)}hasAd(){return!this.reachedAdMax}showMidgameAd(t){return this.showRewardedAd(t)}showRewardedAd(t){if(!t.isTrusted)throw new Error("Ads can only be shown on user gestures");return window.aiptag.adplayer!==void 0?new Promise((n,r)=>{this.res=n,this.rej=r,window.aiptag.cmd.player.push(()=>{window.aiptag.adplayer.startRewardedAd()})}):(this.reachedAdMax=!0,Promise.reject({status:"ad-blocked",provider:this}))}};var pe=class{name="applixir";options;reachedAdMax=!1;constructor(t){this.options=t,this.options.zoneId=this.options.zoneId??2050;let n=document.createElement("div");n.id="applixir_vanishing_div",n.hidden=!0;let r=document.createElement("iframe");r.id="applixir_parent",n.appendChild(r),document.body.prepend(n);let i=document.createElement("script");i.type="text/javascript",i.src="https://cdn.applixir.com/applixir.sdk3.0m.js",document.body.appendChild(i)}hasAd(){return!this.reachedAdMax}showMidgameAd(t){return this.showRewardedAd(t)}showRewardedAd(t){if(!t.isTrusted)throw new Error("Ads can only be shown on user gestures");let n=this,r={};return Object.assign(r,this.options),new Promise((i,o)=>{r.adStatusCb=m=>{switch(m){case"sys-closing":case"ad-initready":case"ad-started":case"ad-rewarded":break;case"ad-watched":i(n);break;case"ad-blocker":case"ad-violation":case"ad-maximum":this.reachedAdMax=!0;case"network-error":case"cors-error":case"no-zoneid":case"ad-interrupted":case"ads-unavailable":break;case"ad-rejected":o({status:m,provider:this});break}},invokeApplixirVideoUnit(r)})}};function st(e,t,n){let r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);let i="expires="+r.toUTCString();document.cookie=e+"="+t+";"+i+";path=/"}function at(e){let t=e+"=",n=document.cookie.split(";");for(let r=0;r<n.length;r++){let i=n[r];for(;i.charAt(0)==" ";)i=i.substring(1);if(i.indexOf(t)==0)return i.substring(t.length,i.length)}return""}var ge=class{cookieKey;name="cookie";available=!0;constructor(t="save-game"){this.cookieKey=t}save(t){st(this.cookieKey,JSON.stringify(t),365)}load(t){t=t??{};let n=at(this.cookieKey),r=n?JSON.parse(n):null;return r?(Object.assign(t,r),t):null}};var ue=class{name="crazygames";hasAds=!1;onReady;ready=!1;user=null;get isLoggedIn(){return this.user!=null}cgUser=null;constructor(){let t,n;this.onReady=new Promise((i,o)=>{t=i,n=o});let r=document.createElement("script");r.onerror=n,r.onload=async()=>{await window.CrazyGames.SDK.init(),window.CrazyGames.SDK.ad.hasAdblock().then(i=>this.hasAds=i),window.CrazyGames.SDK.user.addAuthListener(i=>{this.cgUser=i,this.user={name:this.cgUser.username,profilePictureUrl:this.cgUser.profilePictureUrl}}),window.CrazyGames.SDK.user.getUser().then(i=>{i&&(this.cgUser=i,this.user={name:this.cgUser.username,profilePictureUrl:this.cgUser.profilePictureUrl})}),this.ready=!0,t(!0)},r.type="text/javascript",r.src="https://sdk.crazygames.com/crazygames-sdk-v3.js",document.body.appendChild(r)}hasAd(){return this.ready&&!this.hasAds}showRewardedAd(t){return this._showAd(t,"rewarded")}showMidgameAd(t){return this._showAd(t,"midgame")}_showAd(t,n){if(!t.isTrusted)throw new Error("Ads can only be shown on user gestures");let r=this;return new Promise((i,o)=>{let m={adFinished:()=>i(r),adError:y=>{switch(y.code){case"unfilled":o({status:y.code,provider:this});break;case"other":o({status:y.message,provider:this});break}},adStarted:()=>console.log("Start rewarded ad")};window.CrazyGames.SDK.ad.requestAd(n,m)})}trackGameplayStart(){window.CrazyGames.SDK.game.gameplayStart()}trackGameplayStop(){window.CrazyGames.SDK.game.gameplayStop()}trackLoadingStart(){window.CrazyGames.SDK.game.loadingStart()}trackLoadingStop(){window.CrazyGames.SDK.game.loadingStop()}requestLogin(){return new Promise((t,n)=>{window.CrazyGames.SDK.user.showAuthPrompt().then(r=>{this.cgUser=r,this.user={name:this.cgUser.username,profilePictureUrl:this.cgUser.profilePictureUrl},t(this.user)}).catch(n)})}load(t){t=t??{};let n=window.CrazyGames.SDK.data.getItem("save-game");return n?(Object.assign(t,JSON.parse(n)),t):null}save(t){window.CrazyGames.SDK.data.setItem("save-game",JSON.stringify(t))}celebrate(){window.CrazyGames.SDK.game.happytime()}};var we=class{name="poki";onReady;hasAds=!1;ready=!1;constructor(){let t,n;this.onReady=new Promise((i,o)=>{t=i,n=o});let r=document.createElement("script");r.onerror=n,r.onload=async()=>{await window.PokiSDK.init().then(()=>{console.log("Poki SDK successfully initialized"),this.ready=!0,t(!0)}).catch(()=>{console.log("Initialized, something went wrong, load you game anyway")})},r.type="text/javascript",r.src="https://game-cdn.poki.com/scripts/v2/poki-sdk.js",document.body.appendChild(r)}hasAd(){return this.ready&&!this.hasAds}showRewardedAd(t){if(!t.isTrusted)throw new Error("Ads can only be shown on user gestures");return new Promise(async(n,r)=>{try{window.PokiSDK.rewardedBreak()?n(this):r({status:"unfilled",provider:this})}catch{r({status:"Unknown message",provider:this})}})}showMidgameAd(t){if(!t.isTrusted)throw new Error("Ads can only be shown on user gestures");return new Promise(async(n,r)=>{try{window.PokiSDK.commercialBreak()?n(this):r({status:"unfilled",provider:this})}catch{r({status:"Unknown message",provider:this})}})}trackGameplayStart(){window.PokiSDK.gameplayStart()}trackGameplayStop(){window.PokiSDK.gameplayStop()}trackLoadingStart(){}trackLoadingStop(){window.PokiSDK.gameLoadingFinished()}};var fe=class{name="heyvr";_user=null;_gameId;available=!1;constructor(t,n){if(this._gameId=t,n){this.available=!0;let r=document.createElement("script");r.crossOrigin="no-cors",r.src="https://static.heyvr.io/sdk/heyvr/latest.sandbox.js",r.onload=()=>this.onInit(),document.head.appendChild(r);return}window.location.hostname==="games.heyvr.io"&&(this.available=!0,window.heyVR?.user?this.onInit():window.addEventListener("heyVR.SDKLoaded",this.onInit.bind(this)))}get user(){return this._user}get isLoggedIn(){return!!this._user}_onReadyResolve;_onReadyReject;onReady=new Promise((t,n)=>{this._onReadyResolve=t,this._onReadyReject=n});onAuthChange=new B;ready=!1;ownedItems=[];isReady(){return this.ready}async onInit(){if(window.heyVR.user.onAuthChange(n=>{n.loggedIn?this._user={name:n.username}:this._user=null}),await window.heyVR.user.isLoggedIn())this.onLoggedIn();else throw Error("Not logged in")}async requestLogin(){if(this._user)return Promise.resolve(this._user);let t=await window.heyVR.user.openLogin();return this._user={name:t.username},this.onLoggedIn(),this._user}onLoggedIn(){let t=window.heyVR.user.getName().then(r=>{this._user?this._user.name=r:this._user={name:r}}).catch(console.error),n=window.heyVR.inventory.get().then(r=>{this.ownedItems=r.map(i=>i.slug)});Promise.all([t,n]).then(()=>{this.ready=!0,this._onReadyResolve()})}save(t,n){return this.onReady.then(()=>this.isLoggedIn?window.heyVR.saveGame.write(t,!0,n):!1)}load(t,n=1){return this.onReady.then(()=>this.isLoggedIn?window.heyVR.saveGame.all():null).then(r=>r&&n.toString()in r?window.heyVR.saveGame.load(n):null).then(r=>r?Object.assign(t??{},r):t??null)}isItemPurchased(t){return this.ownedItems.includes(t)}async purchaseItem(t,n){let r=await window.heyVR.inventory.purchase(t,n??1);return r&&this.ownedItems.push(t),!!r}getScores(t,n){return this.onReady.then(()=>this.isLoggedIn?window.heyVR.leaderboard.getMy(t,n).then(r=>r.map(i=>({user:i.user,rank:i.rank,score:i.score,updatedAt:i.created_at}))):[])}postScore(t,n){return window.heyVR.leaderboard.postScore(t,n)}getItemURL(t){return window.heyVR.inventory.getItemURL(this._gameId,t)}};var ye=class{constructor(t="save-game"){this.storageKey=t}name="localStorage";available=!0;save(t){localStorage.setItem(this.storageKey,JSON.stringify(t))}load(t){let n=localStorage.getItem(this.storageKey),r=n?JSON.parse(n):null;return r?(Object.assign(t,r),t):null}};export{f as AbstractGlobalProvider,xe as AdError,de as AdInPlayAdProvider,pe as AppLixirAdProvider,ge as CookieSaveGameProvider,ue as CrazyGamesProvider,fe as HeyVRProvider,ye as LocalStorageSaveGameProvider,we as PokiProvider,ht as ads,Qt as analytics,qt as extra,at as getCookie,an as leaderboards,tn as purchases,$t as saveGame,st as setCookie,Ot as user};
